<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <?define SettingsV2AssetsFiles=icon.ico;LockScreenLogo.scale-200.png;logo.png;Logo.scale-200.png;logo150.png;logo44.png;SplashScreen.png;SplashScreen.scale-200.png;Square150x150Logo.scale-200.png;Square44x44Logo.scale-200.png;Square44x44Logo.targetsize-24_altform-unplated.png;StoreLogo.png;StoreLogo.scale-100.png;Wide310x150Logo.scale-200.pngicon.ico;LockScreenLogo.scale-200.png;logo.png;Logo.scale-200.png;logo150.png;logo44.png;SplashScreen.png;SplashScreen.scale-200.png;Square150x150Logo.scale-200.png;Square44x44Logo.scale-200.png;Square44x44Logo.targetsize-24_altform-unplated.png;StoreLogo.png;StoreLogo.scale-100.png;Wide310x150Logo.scale-200.pngicon.ico;LockScreenLogo.scale-200.png;logo.png;Logo.scale-200.png;logo150.png;logo44.png;SplashScreen.png;SplashScreen.scale-200.png;Square150x150Logo.scale-200.png;Square44x44Logo.scale-200.png;Square44x44Logo.targetsize-24_altform-unplated.png;StoreLogo.png;StoreLogo.scale-100.png;Wide310x150Logo.scale-200.png?>
  <?define SettingsV2AssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\?>

  <?define SettingsV2AssetsModulesFiles=AdvancedPaste.png;AlwaysOnTop.png;APDialog.dark.png;APDialog.light.png;Awake.png;CmdNotFound.png;ColorPicker.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;HostsFileEditor.png;ImageResizer.png;KBM.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerLauncher.png;PowerRename.png;PT.png;QuickAccent.png;RegistryPreview.png;Run.png;ScreenRuler.png;ShortcutGuide.png;TextExtractor.png;Wallpaper.png;Workspaces.png;ZoomIt.pngAdvancedPaste.png;AlwaysOnTop.png;APDialog.dark.png;APDialog.light.png;Awake.png;CmdNotFound.png;ColorPicker.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;HostsFileEditor.png;ImageResizer.png;KBM.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerLauncher.png;PowerRename.png;PT.png;QuickAccent.png;RegistryPreview.png;Run.png;ScreenRuler.png;ShortcutGuide.png;TextExtractor.png;Wallpaper.png;Workspaces.png;ZoomIt.pngAdvancedPaste.png;AlwaysOnTop.png;APDialog.dark.png;APDialog.light.png;Awake.png;CmdNotFound.png;ColorPicker.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;HostsFileEditor.png;ImageResizer.png;KBM.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerLauncher.png;PowerRename.png;PT.png;QuickAccent.png;RegistryPreview.png;Run.png;ScreenRuler.png;ShortcutGuide.png;TextExtractor.png;Wallpaper.png;Workspaces.png;ZoomIt.png?>
  <?define SettingsV2AssetsModulesFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Modules\?>

  <?define SettingsV2OOBEAssetsModulesFiles=AdvancedPaste.gif;AlwaysOnTop.png;Awake.png;CmdNotFound.png;ColorPicker.gif;CropAndLock.gif;EnvironmentVariables.png;FancyZones.gif;FileExplorer.png;FileLocksmith.gif;HostsFileEditor.png;ImageResizer.gif;KBM.gif;MouseUtils.gif;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.gif;PTHero.png;PTHeroShort.png;QuickAccent.gif;RegistryPreview.png;Run.gif;ScreenRuler.gif;ShortcutGuide.png;TextExtractor.gif;Workspaces.png;ZoomIt.gifAdvancedPaste.gif;AlwaysOnTop.png;Awake.png;CmdNotFound.png;ColorPicker.gif;CropAndLock.gif;EnvironmentVariables.png;FancyZones.gif;FileExplorer.png;FileLocksmith.gif;HostsFileEditor.png;ImageResizer.gif;KBM.gif;MouseUtils.gif;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.gif;PTHero.png;PTHeroShort.png;QuickAccent.gif;RegistryPreview.png;Run.gif;ScreenRuler.gif;ShortcutGuide.png;TextExtractor.gif;Workspaces.png;ZoomIt.gifAdvancedPaste.gif;AlwaysOnTop.png;Awake.png;CmdNotFound.png;ColorPicker.gif;CropAndLock.gif;EnvironmentVariables.png;FancyZones.gif;FileExplorer.png;FileLocksmith.gif;HostsFileEditor.png;ImageResizer.gif;KBM.gif;MouseUtils.gif;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.gif;PTHero.png;PTHeroShort.png;QuickAccent.gif;RegistryPreview.png;Run.gif;ScreenRuler.gif;ShortcutGuide.png;TextExtractor.gif;Workspaces.png;ZoomIt.gif?>
  <?define SettingsV2OOBEAssetsModulesFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Modules\OOBE\?>

  <?define SettingsV2OOBEAssetsFluentIconsFiles=Advanced.png;AdvancedPaste.png;AlwaysOnTop.png;Awake.png;ColorPicker.png;CommandNotFound.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;FileManagement.png;FindMyMouse.png;Hosts.png;ImageResizer.png;InputOutput.png;KeyboardManager.png;MouseCrosshairs.png;MouseHighlighter.png;MouseJump.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.png;PowerToys.png;PowerToysRun.png;QuickAccent.png;RegistryPreview.png;ScreenRuler.png;SemanticKernel.png;ShortcutGuide.png;SystemTools.png;TextExtractor.png;WindowingAndLayouts.png;Workspaces.png;ZoomIt.pngAdvanced.png;AdvancedPaste.png;AlwaysOnTop.png;Awake.png;ColorPicker.png;CommandNotFound.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;FileManagement.png;FindMyMouse.png;Hosts.png;ImageResizer.png;InputOutput.png;KeyboardManager.png;MouseCrosshairs.png;MouseHighlighter.png;MouseJump.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.png;PowerToys.png;PowerToysRun.png;QuickAccent.png;RegistryPreview.png;ScreenRuler.png;SemanticKernel.png;ShortcutGuide.png;SystemTools.png;TextExtractor.png;WindowingAndLayouts.png;Workspaces.png;ZoomIt.pngAdvanced.png;AdvancedPaste.png;AlwaysOnTop.png;Awake.png;ColorPicker.png;CommandNotFound.png;CropAndLock.png;EnvironmentVariables.png;FancyZones.png;FileExplorerPreview.png;FileLocksmith.png;FileManagement.png;FindMyMouse.png;Hosts.png;ImageResizer.png;InputOutput.png;KeyboardManager.png;MouseCrosshairs.png;MouseHighlighter.png;MouseJump.png;MouseUtils.png;MouseWithoutBorders.png;NewPlus.png;Peek.png;PowerRename.png;PowerToys.png;PowerToysRun.png;QuickAccent.png;RegistryPreview.png;ScreenRuler.png;SemanticKernel.png;ShortcutGuide.png;SystemTools.png;TextExtractor.png;WindowingAndLayouts.png;Workspaces.png;ZoomIt.png?>
  <?define SettingsV2OOBEAssetsFluentIconsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Settings\Icons\?>

  <Fragment>
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="SettingsV2AssetsInstallFolder" Name="Settings">
        <Directory Id="SettingsAppAssetsScriptsFolder" Name="Scripts" />
        <Directory Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" Name="Icons" />
        <Directory Id="SettingsV2AssetsModulesInstallFolder" Name="Modules">
          <Directory Id="SettingsV2OOBEAssetsModulesInstallFolder" Name="OOBE" />
        </Directory>
      </Directory>
    </DirectoryRef>

    <DirectoryRef Id="SettingsV2AssetsInstallFolder" FileSource="$(var.SettingsV2AssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="SettingsV2AssetsFiles_Component" Win64="yes" Guid="13677681-2733-47DA-8D30-4F687575EF92">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="SettingsV2AssetsFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="SettingsV2AssetsFiles_File_" Source="$(var.SettingsV2AssetsFilesPath)\" />
            </Component>

    </DirectoryRef>

    <DirectoryRef Id="SettingsV2AssetsModulesInstallFolder" FileSource="$(var.SettingsV2AssetsModulesFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="SettingsV2AssetsModulesFiles_Component" Win64="yes" Guid="5AE32787-7BFA-4511-9CE3-DCE4621B931C">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="SettingsV2AssetsModulesFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="SettingsV2AssetsModulesFiles_File_" Source="$(var.SettingsV2AssetsModulesFilesPath)\" />
            </Component>

    </DirectoryRef>

    <DirectoryRef Id="SettingsV2OOBEAssetsModulesInstallFolder" FileSource="$(var.SettingsV2OOBEAssetsModulesFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="SettingsV2OOBEAssetsModulesFiles_Component" Win64="yes" Guid="8964F987-E750-4C22-9776-0E3F0B5E4A43">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="SettingsV2OOBEAssetsModulesFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="SettingsV2OOBEAssetsModulesFiles_File_" Source="$(var.SettingsV2OOBEAssetsModulesFilesPath)\" />
            </Component>

    </DirectoryRef>

    <DirectoryRef Id="SettingsV2OOBEAssetsFluentIconsInstallFolder" FileSource="$(var.SettingsV2OOBEAssetsFluentIconsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->

            <Component Id="SettingsV2OOBEAssetsFluentIconsFiles_Component" Win64="yes" Guid="BA9D085A-3A29-4467-9BD3-48D1A27BBCA5">
              <RegistryKey Root="HKLM" Key="Software\Classes\powertoys\components">
                <RegistryValue Type="string" Name="SettingsV2OOBEAssetsFluentIconsFiles_Component" Value="" KeyPath="yes"/>
              </RegistryKey>
              <File Id="SettingsV2OOBEAssetsFluentIconsFiles_File_" Source="$(var.SettingsV2OOBEAssetsFluentIconsFilesPath)\" />
            </Component>

    </DirectoryRef>

    <DirectoryRef Id="SettingsAppAssetsScriptsFolder" FileSource="$(var.SettingsV2AssetsFilesPath)\Scripts\">
      <Component Id="CommandNotFound_Scripts" Guid="898EFA1E-EDD3-4F4B-8C7F-4A14B0D05B02" Bitness="always64">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="CommandNotFound_Scripts" Value="" KeyPath="yes" />
        </RegistryKey>
        <File Id="CommandNotFound_Scripts_EnableModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\EnableModule.ps1" />
        <File Id="CommandNotFound_Scripts_UpgradeModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\UpgradeModule.ps1" />
        <File Id="CommandNotFound_Scripts_DisableModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\DisableModule.ps1" />
        <File Id="CommandNotFound_Scripts_CheckCmdNotFoundRequirements.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\CheckCmdNotFoundRequirements.ps1" />
        <File Id="CommandNotFound_Scripts_InstallWinGetClientModule.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\InstallWinGetClientModule.ps1" />
        <File Id="CommandNotFound_Scripts_InstallPowerShell7.ps1" Source="$(var.SettingsV2AssetsFilesPath)\Scripts\InstallPowerShell7.ps1" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="SettingsComponentGroup">

      <Component Id="RemoveSettingsFolder" Guid="2D3AEF68-4E5A-4FF9-A5C0-9E53391AC754" Directory="SettingsV2AssetsInstallFolder">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveSettingsFolder" Value="" KeyPath="yes" />
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderSettingsV2AssetsInstallFolder" Directory="SettingsV2AssetsInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2OOBEAssetsFluentIconsInstallFolder" Directory="SettingsV2OOBEAssetsFluentIconsInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2AssetsModulesInstallFolder" Directory="SettingsV2AssetsModulesInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsV2OOBEAssetsModulesInstallFolder" Directory="SettingsV2OOBEAssetsModulesInstallFolder" On="uninstall" />
        <RemoveFolder Id="RemoveFolderSettingsAppAssetsScriptsFolder" Directory="SettingsAppAssetsScriptsFolder" On="uninstall" />
      </Component>
      <ComponentRef Id="CommandNotFound_Scripts" />
            <ComponentRef Id="SettingsV2AssetsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsFluentIconsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsFluentIconsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsFluentIconsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsFiles_Component" />
            <ComponentRef Id="SettingsV2AssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsModulesFiles_Component" />
            <ComponentRef Id="SettingsV2OOBEAssetsFluentIconsFiles_Component" />
    </ComponentGroup>

  </Fragment>
</Wix>
